:host {
  --bg: #f6f7f9;
  --panel: #ffffff;
  --panel2: #fbfbfc;

  --text: rgba(0,0,0,0.86);
  --muted: rgba(0,0,0,0.55);
  --stroke: rgba(0,0,0,0.10);
  --stroke2: rgba(0,0,0,0.16);

  --shadow: 0 18px 50px rgba(0,0,0,0.08);
  --shadow2: 0 10px 30px rgba(0,0,0,0.10);

  --c-now: #16a34a;
  --c-soon: #f59e0b;
  --c-late: #dc2626;

  display: block;
  color: var(--text);
}

.page {
  padding: 16px 16px 22px;
  background: var(--bg);
  min-height: calc(100vh - 64px);
  overflow-x: hidden;
}

/* TOP */
.top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
  padding: 14px;
  background: var(--panel);
  border: 1px solid var(--stroke);
  border-radius: 18px;
  box-shadow: var(--shadow);
  min-width: 0;
}

.title {
  display: flex;
  align-items: center;
  gap: 12px;
  min-width: 0;
}

.mark {
  width: 44px;
  height: 44px;
  border-radius: 16px;
  display: grid;
  place-items: center;
  font-weight: 900;
  letter-spacing: .6px;
  background: #111;
  color: #fff;
  flex: 0 0 auto;
}

.title__text { min-width: 0; display: grid; gap: 2px; }
.title__text h1 { margin: 0; font-size: 16px; letter-spacing: .2px; }
.title__text p {
  margin: 0;
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.top__right {
  display: grid;
  gap: 10px;
  justify-items: end;
  min-width: 0;
}

.meta {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
}
.meta__item {
  padding: 8px 10px;
  border: 1px solid var(--stroke);
  border-radius: 14px;
  background: var(--panel2);
  display: grid;
  gap: 2px;
  min-width: 130px;
}
.meta__label { font-size: 11px; color: var(--muted); }
.meta__value { font-size: 12px; font-weight: 900; }
.meta__sub { font-size: 11px; color: var(--muted); }

.controls {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.field {
  display: flex;
  align-items: center;
  gap: 10px;
  height: 40px;
  padding: 0 12px;
  border-radius: 14px;
  border: 1px solid var(--stroke);
  background: var(--panel2);
}
.field__icon { opacity: .75; display: inline-flex; }
.field__icon svg { fill: rgba(0,0,0,0.55); }

.date {
  border: 0;
  background: transparent;
  outline: none;
  font-size: 13px;
  color: var(--text);
}

/* Buttons */
.btn {
  height: 40px;
  padding: 0 14px;
  border-radius: 14px;
  border: 1px solid var(--stroke);
  background: #fff;
  color: var(--text);
  cursor: pointer;
  font-size: 13px;
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}
.btn:hover {
  transform: translateY(-1px);
  border-color: var(--stroke2);
  box-shadow: var(--shadow2);
}
.btn:disabled { opacity: .55; cursor: not-allowed; transform: none; box-shadow: none; }
.btn--ghost { background: transparent; }
.btn--primary { background: #111; color: #fff; border-color: rgba(0,0,0,0.18); }
.btn--danger { background: #fff; color: #b00020; border-color: rgba(176,0,32,0.25); }
.btn--small { height: 36px; padding: 0 12px; border-radius: 12px; font-size: 12px; }

/* FILTERS */
.filters {
  margin-top: 12px;
  display: grid;
  grid-template-columns: 1fr 360px;
  grid-template-rows: auto auto;
  grid-template-areas:
    "chips search"
    "sub   sub";
  gap: 12px;
  min-width: 0;
}

.chips { grid-area: chips; display: flex; gap: 10px; flex-wrap: wrap; }

.chip {
  height: 38px;
  padding: 0 12px;
  border-radius: 999px;
  border: 1px solid var(--stroke);
  background: #fff;
  display: inline-flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
}
.chip:hover { transform: translateY(-1px); border-color: var(--stroke2); box-shadow: var(--shadow2); }
.chip strong {
  font-size: 12px;
  padding: 3px 8px;
  border-radius: 999px;
  background: rgba(0,0,0,0.06);
}
.chip.active { background: #111; color: #fff; border-color: rgba(0,0,0,0.22); }
.chip.active strong { background: rgba(255,255,255,0.16); }

.search {
  grid-area: search;
  height: 44px;
  border-radius: 16px;
  border: 1px solid var(--stroke);
  background: #fff;
  display: flex;
  align-items: center;
  padding: 0 12px;
  gap: 10px;
  box-shadow: var(--shadow);
  min-width: 0;
}
.search__icon svg { fill: rgba(0,0,0,0.55); }
.search__input { border: 0; outline: none; flex: 1; font-size: 13px; min-width: 0; }
.search__clear {
  height: 34px;
  padding: 0 10px;
  border-radius: 12px;
  border: 1px solid var(--stroke);
  background: transparent;
  cursor: pointer;
  font-size: 12px;
}

.subfilters {
  grid-area: sub;
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
  justify-content: space-between;
  min-width: 0;
}

.seg {
  display: inline-flex;
  border: 1px solid var(--stroke);
  border-radius: 14px;
  overflow: hidden;
  background: #fff;
}
.seg__btn {
  height: 36px;
  padding: 0 12px;
  border: 0;
  background: transparent;
  cursor: pointer;
  font-size: 12px;
  color: rgba(0,0,0,0.70);
}
.seg__btn.active { background: #111; color: #fff; }
.nav { display: flex; gap: 8px; }

/* ALERT */
.alert {
  margin-top: 12px;
  padding: 12px 14px;
  background: #fff;
  border: 1px solid rgba(176,0,32,0.25);
  border-radius: 16px;
  box-shadow: var(--shadow);
  color: rgba(176,0,32,0.95);
}

/* GRID */
.grid {
  margin-top: 12px;
  display: grid;
  grid-template-columns: 1.45fr 1fr;
  gap: 12px;
  min-width: 0;
}

.panel {
  background: #fff;
  border: 1px solid var(--stroke);
  border-radius: 18px;
  box-shadow: var(--shadow);
  overflow: hidden;
  min-width: 0;
}

.panel__head {
  padding: 14px;
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 12px;
  border-bottom: 1px solid rgba(0,0,0,0.06);
  min-width: 0;
}

.panel__head h2 { margin: 0; font-size: 14px; letter-spacing: .2px; }
.muted { color: var(--muted); margin: 4px 0 0; font-size: 12px; }

/* LIST */
.panel--list {
  display: grid;
  grid-template-rows: auto 1fr;
  min-height: 520px;
  min-width: 0;
}

.list {
  padding: 10px;
  overflow: auto;
  overflow-x: hidden; /* clave para no desbordar */
  max-height: calc(100vh - 310px);
  min-width: 0;
}

.legend {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
  justify-content: flex-end;
}
.lg { font-size: 12px; color: var(--muted); display: inline-flex; gap: 6px; align-items: center; }
.dot { width: 8px; height: 8px; border-radius: 999px; display: inline-block; }
.dot--now { background: var(--c-now); }
.dot--soon { background: var(--c-soon); }
.dot--late { background: var(--c-late); }

.group { margin-bottom: 10px; }
.group__title {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 8px 6px;
  position: sticky;
  top: 0;
  background: #fff;
  z-index: 2;
}
.hr { font-size: 12px; color: var(--muted); min-width: 48px; }
.line { height: 1px; flex: 1; background: rgba(0,0,0,0.08); }

/* ROW (más compacta y sin ruido) */
.row {
  border: 1px solid rgba(0,0,0,0.08);
  background: #fff;
  border-radius: 16px;
  padding: 12px;
  display: grid;
  grid-template-columns: 8px 170px minmax(0, 1fr) auto; /* minmax evita overflow */
  gap: 12px;
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease;
  margin-bottom: 10px;
  outline: none;
  align-items: center;
  min-width: 0;
}
.row:focus-visible { box-shadow: 0 0 0 3px rgba(0,0,0,0.12), var(--shadow2); }
.row:hover { transform: translateY(-1px); border-color: rgba(0,0,0,0.14); box-shadow: var(--shadow2); }
.row.selected { border-color: rgba(0,0,0,0.22); background: rgba(0,0,0,0.02); }

/* Estados (llamativos pero limpios) */
.row.is-now { border-color: rgba(22,163,74,0.35); background: linear-gradient(90deg, rgba(22,163,74,0.10), transparent 35%); }
.row.is-soon { border-color: rgba(245,158,11,0.30); background: linear-gradient(90deg, rgba(245,158,11,0.10), transparent 35%); }
.row.is-late { border-color: rgba(220,38,38,0.30); background: linear-gradient(90deg, rgba(220,38,38,0.10), transparent 35%); }

.row__bar { border-radius: 999px; background: rgba(0,0,0,0.10); align-self: stretch; }
.row.is-now .row__bar { background: var(--c-now); }
.row.is-soon .row__bar { background: var(--c-soon); }
.row.is-late .row__bar { background: var(--c-late); }

/* Hora */
.row__time { min-width: 0; }
.row__time .t1 { display: block; font-size: 13px; white-space: nowrap; }
.row__time .t2 { display: block; font-size: 12px; color: var(--muted); margin-top: 3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* Cliente + estado */
.row__main { min-width: 0; }
.row__top { display: flex; align-items: flex-start; justify-content: space-between; gap: 10px; min-width: 0; }
.who { display: grid; gap: 3px; min-width: 0; }
.name {
  font-weight: 900;
  font-size: 13px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.sub {
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Meta simple */
.row__metaSimple {
  margin-top: 10px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}

/* Tags */
.tag {
  font-size: 11px;
  font-weight: 900;
  letter-spacing: .2px;
  padding: 5px 10px;
  border-radius: 999px;
  border: 1px solid rgba(0,0,0,0.10);
  background: rgba(0,0,0,0.03);
  white-space: nowrap;
}
.tag--now { border-color: rgba(22,163,74,0.30); background: rgba(22,163,74,0.10); color: rgba(22,163,74,0.95); }
.tag--soon { border-color: rgba(245,158,11,0.30); background: rgba(245,158,11,0.10); color: rgba(180,83,9,0.95); }
.tag--late { border-color: rgba(220,38,38,0.30); background: rgba(220,38,38,0.10); color: rgba(220,38,38,0.95); }

.pill--ghost {
  font-size: 11px;
  font-weight: 900;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(0,0,0,0.10);
  background: rgba(0,0,0,0.03);
  color: rgba(0,0,0,0.75);
  white-space: nowrap;
}

/* Acciones rápidas: solo en hover/selected */
.row__right { display: flex; align-items: center; justify-content: flex-end; min-width: 0; }

.quickActions {
  display: flex;
  align-items: center;
  gap: 8px;
  opacity: 0;
  pointer-events: none;
  transform: translateY(1px);
  transition: opacity .14s ease, transform .14s ease;
}
.row:hover .quickActions,
.row.selected .quickActions,
.row:focus-visible .quickActions {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

.q {
  height: 32px;
  padding: 0 10px;
  border-radius: 12px;
  border: 1px solid rgba(0,0,0,0.12);
  background: #fff;
  cursor: pointer;
  font-size: 12px;
  white-space: nowrap;
}
.q:disabled { opacity: .55; cursor: not-allowed; }
.q--ok { background: #111; color: #fff; border-color: rgba(0,0,0,0.18); }

/* Badges */
.badge {
  font-size: 11px;
  font-weight: 900;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(0,0,0,0.10);
  background: rgba(0,0,0,0.04);
  color: rgba(0,0,0,0.80);
  white-space: nowrap;
  flex: 0 0 auto;
}
.badge--reserved { background: #111; color: #fff; border-color: rgba(0,0,0,0.20); }
.badge--attended { background: rgba(0,0,0,0.08); }
.badge--cancelled { background: rgba(176,0,32,0.06); border-color: rgba(176,0,32,0.20); color: rgba(176,0,32,0.90); }
.badge--no_show { background: rgba(0,0,0,0.06); }

/* DETAIL */
.panel--detail { position: sticky; top: 76px; height: fit-content; min-width: 0; }

/* Hero */
.hero {
  margin: 12px;
  border-radius: 18px;
  border: 1px solid rgba(0,0,0,0.10);
  background: #fff;
  padding: 12px;
}
.hero--now { border-color: rgba(22,163,74,0.30); background: linear-gradient(135deg, rgba(22,163,74,0.10), #fff 55%); }
.hero--soon { border-color: rgba(245,158,11,0.25); background: linear-gradient(135deg, rgba(245,158,11,0.10), #fff 55%); }
.hero--late { border-color: rgba(220,38,38,0.25); background: linear-gradient(135deg, rgba(220,38,38,0.10), #fff 55%); }

.hero__top { display: grid; grid-template-columns: minmax(0, 1fr) 220px; gap: 12px; align-items: start; }
.hero__name { font-weight: 900; font-size: 15px; }
.hero__sub { margin-top: 4px; color: var(--muted); font-size: 12px; }
.hero__chips { margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }

.hero__right { display: grid; gap: 8px; justify-items: end; min-width: 0; }
.hero__rel { font-weight: 900; font-size: 12px; color: rgba(0,0,0,0.70); }
.hero__prog { width: 100%; height: 8px; border-radius: 999px; background: rgba(0,0,0,0.06); overflow: hidden; }
.hero__fill { display: block; height: 100%; width: 0%; background: rgba(0,0,0,0.55); }
.hero--now .hero__fill { background: var(--c-now); }
.hero--soon .hero__fill { background: var(--c-soon); }
.hero--late .hero__fill { background: var(--c-late); }

.hero__actions { margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
.btn2 {
  height: 34px;
  padding: 0 12px;
  border-radius: 12px;
  border: 1px solid rgba(0,0,0,0.12);
  background: #fff;
  cursor: pointer;
  font-size: 12px;
  font-weight: 900;
  white-space: nowrap;
}
.btn2:disabled { opacity: .55; cursor: not-allowed; }
.btn2--ok { background: #111; color: #fff; border-color: rgba(0,0,0,0.18); }
.btn2--danger { color: rgba(176,0,32,0.92); border-color: rgba(176,0,32,0.25); }
.sep { width: 1px; height: 18px; background: rgba(0,0,0,0.10); margin: 0 2px; }

/* Cards */
.card {
  margin: 12px;
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 18px;
  padding: 12px;
  background: #fff;
}
.card__title {
  font-size: 11px;
  letter-spacing: .6px;
  font-weight: 900;
  text-transform: uppercase;
  margin-bottom: 10px;
  color: rgba(0,0,0,0.70);
}
.card__row {
  display: grid;
  grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
  gap: 10px;
  margin-bottom: 10px;
}
.k { display: grid; gap: 3px; min-width: 0; }
.k__label { font-size: 11px; color: var(--muted); }
.k__value { font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.k__sub { font-size: 12px; color: rgba(176,0,32,0.85); font-weight: 900; }

/* Blocks */
.svc { border-top: 1px dashed rgba(0,0,0,0.10); padding-top: 10px; margin-top: 10px; }
.svc__head { display: flex; justify-content: space-between; gap: 10px; align-items: baseline; }
.svc__wk { font-size: 12px; font-weight: 900; }
.svc__list { margin-top: 10px; display: grid; gap: 10px; }
.svc__item { display: flex; gap: 10px; align-items: flex-start; min-width: 0; }
.svc__dot { width: 10px; height: 10px; border-radius: 999px; background: rgba(0,0,0,0.25); margin-top: 5px; flex: 0 0 auto; }
.svc__txt { min-width: 0; }
.svc__txt strong { font-size: 13px; display: block; }
.svc__txt .muted { margin: 2px 0 0; }

.total {
  margin-top: 12px;
  padding-top: 10px;
  border-top: 1px solid rgba(0,0,0,0.08);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* Empty + Skeleton */
.empty {
  padding: 18px;
  display: flex;
  align-items: center;
  gap: 12px;
  color: var(--muted);
}
.empty__icon {
  width: 44px; height: 44px;
  border-radius: 16px;
  display: grid;
  place-items: center;
  background: rgba(0,0,0,0.06);
  color: rgba(0,0,0,0.65);
  font-weight: 900;
}
.empty__txt { display: grid; gap: 2px; }
.empty__txt strong { color: rgba(0,0,0,0.75); }

.skeleton { padding: 12px; display: grid; gap: 10px; }
.sk-row {
  height: 62px;
  border-radius: 16px;
  background: linear-gradient(90deg, rgba(0,0,0,0.04), rgba(0,0,0,0.08), rgba(0,0,0,0.04));
  background-size: 200% 100%;
  animation: shimmer 1.1s ease infinite;
  border: 1px solid rgba(0,0,0,0.06);
}
@keyframes shimmer {
  0% { background-position: 0% 0%; }
  100% { background-position: -200% 0%; }
}

/* Compact mode */
.panel--list.compact .row { grid-template-columns: 8px 150px minmax(0, 1fr) auto; padding: 10px; }
.panel--list.compact .row__metaSimple { margin-top: 8px; }

/* Modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.28);
  display: grid;
  place-items: center;
  padding: 18px;
  z-index: 50;
}
.modal__card {
  width: min(520px, 96vw);
  border-radius: 18px;
  background: #fff;
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: var(--shadow);
  padding: 14px;
}
.modal__title { font-weight: 900; letter-spacing: .2px; margin-bottom: 6px; }
.modal__text { margin: 0 0 12px; color: rgba(0,0,0,0.72); font-size: 13px; }
.modal__actions { display: flex; justify-content: flex-end; gap: 10px; flex-wrap: wrap; }

/* Toast */
.toast {
  position: fixed;
  right: 16px;
  bottom: 16px;
  z-index: 60;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(0,0,0,0.12);
  background: #fff;
  box-shadow: var(--shadow2);
  font-size: 12px;
  color: rgba(0,0,0,0.82);
  max-width: min(380px, 92vw);
}
.toast.success { border-color: rgba(0,0,0,0.18); }
.toast.info { border-color: rgba(0,0,0,0.12); }
.toast.error { border-color: rgba(176,0,32,0.28); color: rgba(176,0,32,0.92); }

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  * { transition: none !important; animation: none !important; }
}

/* Responsive */
@media (max-width: 1080px) {
  .filters {
    grid-template-columns: 1fr;
    grid-template-areas:
      "chips"
      "search"
      "sub";
  }
  .grid { grid-template-columns: 1fr; }
  .panel--detail { position: static; }
  .list { max-height: none; }
  .top { align-items: flex-start; }
  .top__right { justify-items: start; width: 100%; }
  .meta { justify-content: flex-start; }
  .hero__top { grid-template-columns: 1fr; }
  .hero__right { justify-items: start; }
}

@media (max-width: 720px) {
  .row { grid-template-columns: 8px minmax(0, 1fr); }
  .row__right { display: none; } /* sin ruido en móvil */
  .row__time { display: none; }  /* móvil: menos info */
}

/* =========================
   Mobile: TOP + FILTERS (mejor layout)
   ========================= */
@media (max-width: 560px) {
  .page {
    padding: 12px;
  }

  /* TOP: que no se vea gigante */
  .top {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
    padding: 12px;
    border-radius: 18px;
  }

  .title {
    gap: 10px;
  }

  .mark {
    width: 40px;
    height: 40px;
    border-radius: 14px;
  }

  .title__text h1 {
    font-size: 16px;
  }

  .top__right {
    justify-items: stretch; /* que ocupe todo el ancho */
    gap: 10px;
  }

  /* META en 2 columnas, sin min-width fijo */
  .meta {
    justify-content: stretch;
    gap: 8px;
  }

  .meta__item {
    min-width: 0;               /* clave */
    flex: 1 1 calc(50% - 8px);  /* 2 columnas */
    padding: 8px 10px;
    border-radius: 14px;
  }

  .meta__value {
    font-size: 12px;
  }

  .meta__sub {
    font-size: 11px;
  }

  /* CONTROLES: grid compacto */
  .controls {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    justify-content: stretch;
  }

  .controls .field {
    grid-column: 1 / -1; /* fecha ocupa toda la fila */
    height: 42px;
    border-radius: 16px;
  }

  .controls .btn {
    width: 100%;
    height: 40px;
    border-radius: 16px;
  }

  .controls .btn--primary {
    grid-column: 1 / -1; /* Actualizar ancho completo */
  }

  /* FILTERS: menos alto */
  .filters {
    margin-top: 10px;
    gap: 10px;
  }

  /* CHIPS en una sola fila con scroll horizontal (sin ocupar 3 filas) */
  .chips {
    flex-wrap: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    gap: 8px;
    padding-bottom: 6px;
    scroll-snap-type: x mandatory;
  }

  .chip {
    flex: 0 0 auto;
    scroll-snap-align: start;
    height: 38px;
    border-radius: 999px;
  }

  /* SEARCH full width (ya lo es, pero reforzamos) */
  .search {
    width: 100%;
    border-radius: 16px;
  }

  /* SUBFILTERS: apilado bonito */
  .subfilters {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
    justify-content: stretch;
  }

  .seg {
    width: 100%;
    border-radius: 16px;
  }

  .seg__btn {
    flex: 1 1 auto; /* que queden iguales */
    height: 40px;
  }

  .nav {
    width: 100%;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
  }

  .nav .btn {
    width: 100%;
    height: 40px;
    border-radius: 16px;
  }
}

/* Extra: pantallas muy pequeñas */
@media (max-width: 380px) {
  .controls {
    grid-template-columns: 1fr;
  }

  .nav {
    grid-template-columns: 1fr;
  }
}
